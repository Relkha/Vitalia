<!DOCTYPE html>
<html lang="fr">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <title>Surveillance</title>
    <link rel="stylesheet" href="{% static 'vitalia_app/css/surveillance.css' %}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<header class="header">
    <div class="logo">Vitalia</div>
    <nav class="nav">
        <a href="/">Accueil</a>
        <a href="/dashboard/">Dashboard</a>
        <a href="/surveillance/">Surveillance</a>
        <a href="{% url 'deconnexion' %}">Déconnexion</a>
    </nav>
</header>

<main class="main-content">
    <h1>Caméra d’entrée – Surveillance</h1>

    <div class="video-feed">
        Flux vidéo caméra en direct
    </div>

    <section class="choix-chambre">
        <form method="get" action="">
            <label for="chambre">Choisir une chambre :</label>
            <select name="chambre" id="chambre" onchange="this.form.submit()">
                <option value="">-- Sélectionnez une chambre --</option>
                {% for chambre in chambres %}
                    <option value="{{ chambre.id }}" {% if selected_chambre and chambre.id == selected_chambre.id %}selected{% endif %}>
                        Chambre {{ chambre.numero }}
                    </option>
                {% endfor %}
            </select>
        </form>
    </section>

    {% if selected_chambre %}
        <section class="chambre">
            <h2>Objets connectés – Chambre {{ selected_chambre.numero }}</h2>

            {% if objets_connectes %}
                {% for objet in objets_connectes %}
                    <div class="capteur">
                        {% if objet.type == "presence_sensor" %}
                            <span class="status {% if objet.status == "active" %}active{% else %}inactive{% endif %}"></span>
                            Présence : {{ objet.status|title }}
                        {% elif objet.type == "door_sensor" %}
                            <span class="status {% if objet.status == "fermée" %}closed{% else %}open{% endif %}"></span>
                            Porte : {{ objet.status|title }}
                        {% elif objet.type == "air_quality_sensor" %}
                            <span class="status {% if objet.status == "bonne" %}good{% elif objet.status == "moyenne" %}moyenne{% else %}bad{% endif %}"></span>
                            Qualité air : {{ objet.status|title }}
                        {% elif objet.type == "thermometer" %}
                            <span class="status active"></span>
                            Température : {{ objet.status }}
                        {% endif %}
                    </div>
                {% endfor %}
            {% else %}
                <p>Aucun objet connecté pour cette chambre.</p>
            {% endif %}
        </section>
    {% endif %}
</main>

<footer class="footer">
    &copy; 2025 Vitalia. Tous droits réservés.
</footer>

</body>
</html>
